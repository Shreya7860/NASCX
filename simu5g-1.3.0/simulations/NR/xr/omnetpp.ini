[General]
sim-time-limit = 20s
**.routingRecorder.enabled = false

# Configure enough RNGs for all jitter sources
num-rngs = 20

############### Statistics ##################
output-scalar-file = ${resultdir}/${configname}/${repetition}.sca
output-vector-file = ${resultdir}/${configname}/${repetition}.vec
seed-set = ${repetition}
**.vector-recording = true

############### Mobility parameters #####################
# 250m x 250m deployment area as per specification
**.mobility.constraintAreaMaxX = 250m
**.mobility.constraintAreaMaxY = 250m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.initFromDisplayString = false

############### IPv4 configurator config #################
*.configurator.config = xmldoc("./demo.xml")


#------------------------------------#
# Config NR-XR-Base
#
# Base configuration for NR Standalone with XR traffic parameters
# Uses 100 MHz bandwidth, μ=1 numerology (30 kHz SCS), ~273 RBs
#------------------------------------#
[Config NR-XR-Base]
network = simu5g.simulations.NR.networks.SingleCell_Standalone

############### Carrier Configuration ################
*.carrierAggregation.numComponentCarriers = 1
*.carrierAggregation.componentCarrier[0].carrierFrequency = 2.4GHz
*.carrierAggregation.componentCarrier[0].numBands = 273
*.carrierAggregation.componentCarrier[0].numerologyIndex = 1  # μ=1, 30 kHz SCS

############### Number of Resource Blocks ################
**.numBands = 273  # 100 MHz with 30 kHz SCS

############### gNodeB configuration #################
# gNB positioned at center of 250m x 250m area (BS antenna height: 25m)
*.gnb.mobility.initialX = 125m
*.gnb.mobility.initialY = 125m

############### Transmission Power ##################
# From specification: BS max power = 44 dBm, UE tx power = 23 dBm
**.ueTxPower = 23dBm
**.eNodeBTxPower = 44dBm
**.targetBler = 0.01  # Target BLER = 1%
**.blerShift = 5

############### Channel Model ##################
# Flat Rayleigh fading as per specification
**.channelModel.fading = true
**.channelModel.fading_type = "RAYLEIGH"
**.channelModel.shadowing = false  # Flat channel (no shadowing)

############## UE configuration ##################
*.numUe = 1  # Default: single user (will be overridden in specific configs)

# Connect UEs to gNB (NR Standalone mode)
*.ue[*].macCellId = 0
*.ue[*].masterId = 0
*.ue[*].nrMacCellId = 1
*.ue[*].nrMasterId = 1


#------------------------------------#
# Config XR-DL-SingleUser
#
# Single user XR downlink scenario
# Used to verify baseline operation and that 1 user can be supported
#------------------------------------#
[Config XR-DL-SingleUser]
extends = NR-XR-Base

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"

############## UE configuration ##################
*.numUe = 1

# UE positioned within the 250m x 250m area
*.ue[0].mobility.initialX = 175m
*.ue[0].mobility.initialY = 175m

#============= Application Setup =============
# Server sends XR traffic to UE (downlink)
*.server.numApps = 1

*.server.app[0].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[0].destAddress = "ue[0]"
*.server.app[0].destPort = 3000
*.server.app[0].localPort = 3088
*.server.app[0].startTime = 0.1s
*.server.app[0].fps = 60
*.server.app[0].pcaFile = "xr_traffic_30mbps.csv"

# Jitter parameters (truncated Gaussian: mean -4ms, std 2ms, min -4ms, max +4ms)
*.server.app[0].jitterMean = -4ms
*.server.app[0].jitterStd = 2ms
*.server.app[0].jitterMin = -4ms
*.server.app[0].jitterMax = 4ms
*.server.app[0].jitterSeed = 0

# UE receives XR traffic
*.ue[0].numApps = 1
*.ue[0].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[0].app[0].localPort = 3000
*.ue[0].app[0].deadlineMs = 2.5ms   # 2.5 ms delay bound
*.ue[0].app[0].expectedFrames = 1074  # Matches frame count in PCA data
*.ue[0].app[0].resultFile = "results/user_0_stats.csv"


#------------------------------------#
# Config XR-DL-MultiUser-PF
#
# Multi-user XR downlink with Proportional Fair scheduler
# Variable number of users (2-10) to study capacity limits
#------------------------------------#
[Config XR-DL-MultiUser-PF]
extends = NR-XR-Base

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"

############## UE configuration ##################
*.numUe = ${numUsers=2,3,4,5,6,7,8,9,10}

# Random UE positions in 250m x 250m area (50m-200m range to avoid edges)
*.ue[0].mobility.initialX = 100m
*.ue[0].mobility.initialY = 100m
*.ue[1].mobility.initialX = 150m
*.ue[1].mobility.initialY = 100m
*.ue[2].mobility.initialX = 100m
*.ue[2].mobility.initialY = 150m
*.ue[3].mobility.initialX = 150m
*.ue[3].mobility.initialY = 150m
*.ue[4].mobility.initialX = 75m
*.ue[4].mobility.initialY = 125m
*.ue[5].mobility.initialX = 175m
*.ue[5].mobility.initialY = 125m
*.ue[6].mobility.initialX = 125m
*.ue[6].mobility.initialY = 75m
*.ue[7].mobility.initialX = 125m
*.ue[7].mobility.initialY = 175m
*.ue[8].mobility.initialX = 80m
*.ue[8].mobility.initialY = 80m
*.ue[9].mobility.initialX = 170m
*.ue[9].mobility.initialY = 170m

#============= Application Setup =============
# Server sends XR traffic to all UEs (downlink)
*.server.numApps = ${numUsers}

*.server.app[*].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[*].destAddress = "ue[" + string(ancestorIndex(0)) + "]"
*.server.app[*].destPort = 3000
*.server.app[*].localPort = 3088 + ancestorIndex(0)
*.server.app[*].startTime = uniform(0s, 0.02s)
*.server.app[*].fps = 60
*.server.app[*].pcaFile = "xr_traffic_30mbps.csv"

# Jitter parameters (truncated Gaussian: mean -4ms, std 2ms, min -4ms, max +4ms)
*.server.app[*].jitterMean = -4ms
*.server.app[*].jitterStd = 2ms
*.server.app[*].jitterMin = -4ms
*.server.app[*].jitterMax = 4ms
*.server.app[*].jitterSeed = ancestorIndex(0)

# All UEs receive XR traffic
*.ue[*].numApps = 1
*.ue[*].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[*].app[0].localPort = 3000
*.ue[*].app[0].deadlineMs = 2.5ms   # 2.5 ms delay bound
*.ue[*].app[0].expectedFrames = 1074  # Matches frame count in PCA data


#------------------------------------#
# Config XR-DL-MultiUser-MaxCQI
#
# Multi-user XR downlink with MAX-CQI scheduler
# Variable number of users (2-10) to study capacity limits
#------------------------------------#
[Config XR-DL-MultiUser-MaxCQI]
extends = NR-XR-Base

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "MAXCI"

############## UE configuration ##################
*.numUe = ${numUsers=2,3,4,5,6,7,8,9,10}

# Random UE positions in 250m x 250m area
*.ue[0].mobility.initialX = 100m
*.ue[0].mobility.initialY = 100m
*.ue[1].mobility.initialX = 150m
*.ue[1].mobility.initialY = 100m
*.ue[2].mobility.initialX = 100m
*.ue[2].mobility.initialY = 150m
*.ue[3].mobility.initialX = 150m
*.ue[3].mobility.initialY = 150m
*.ue[4].mobility.initialX = 75m
*.ue[4].mobility.initialY = 125m
*.ue[5].mobility.initialX = 175m
*.ue[5].mobility.initialY = 125m
*.ue[6].mobility.initialX = 125m
*.ue[6].mobility.initialY = 75m
*.ue[7].mobility.initialX = 125m
*.ue[7].mobility.initialY = 175m
*.ue[8].mobility.initialX = 80m
*.ue[8].mobility.initialY = 80m
*.ue[9].mobility.initialX = 170m
*.ue[9].mobility.initialY = 170m

#============= Application Setup =============
*.server.numApps = ${numUsers}

*.server.app[*].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[*].destAddress = "ue[" + string(ancestorIndex(0)) + "]"
*.server.app[*].destPort = 3000
*.server.app[*].localPort = 3088 + ancestorIndex(0)
*.server.app[*].startTime = uniform(0s, 0.02s)
*.server.app[*].fps = 60
*.server.app[*].pcaFile = "xr_traffic_30mbps.csv"

*.server.app[*].jitterMean = -4ms
*.server.app[*].jitterStd = 2ms
*.server.app[*].jitterMin = -4ms
*.server.app[*].jitterMax = 4ms
*.server.app[*].jitterSeed = ancestorIndex(0)

*.ue[*].numApps = 1
*.ue[*].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[*].app[0].localPort = 3000
*.ue[*].app[0].deadlineMs = 2.5ms
*.ue[*].app[0].expectedFrames = 1074


#------------------------------------#
# Config XR-DL-UserSweep
#
# Sweep number of users from 1 to 10 with PF scheduler
# Used to generate results showing capacity limits
#------------------------------------#
[Config XR-DL-UserSweep]
extends = NR-XR-Base

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"

############## UE configuration ##################
*.numUe = ${numUsers=1,2,3,4,5,6,7,8,9,10}

# UE positions distributed in 250m x 250m area
*.ue[0].mobility.initialX = 125m
*.ue[0].mobility.initialY = 175m
*.ue[1].mobility.initialX = 100m
*.ue[1].mobility.initialY = 100m
*.ue[2].mobility.initialX = 150m
*.ue[2].mobility.initialY = 100m
*.ue[3].mobility.initialX = 100m
*.ue[3].mobility.initialY = 150m
*.ue[4].mobility.initialX = 150m
*.ue[4].mobility.initialY = 150m
*.ue[5].mobility.initialX = 75m
*.ue[5].mobility.initialY = 125m
*.ue[6].mobility.initialX = 175m
*.ue[6].mobility.initialY = 125m
*.ue[7].mobility.initialX = 125m
*.ue[7].mobility.initialY = 75m
*.ue[8].mobility.initialX = 80m
*.ue[8].mobility.initialY = 80m
*.ue[9].mobility.initialX = 170m
*.ue[9].mobility.initialY = 170m

#============= Application Setup =============
*.server.numApps = ${numUsers}

*.server.app[*].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[*].destAddress = "ue[" + string(ancestorIndex(0)) + "]"
*.server.app[*].destPort = 3000
*.server.app[*].localPort = 3088 + ancestorIndex(0)
*.server.app[*].startTime = uniform(0s, 0.02s)
*.server.app[*].fps = 60
*.server.app[*].pcaFile = "xr_traffic_30mbps.csv"

*.server.app[*].jitterMean = -4ms
*.server.app[*].jitterStd = 2ms
*.server.app[*].jitterMin = -4ms
*.server.app[*].jitterMax = 4ms
*.server.app[*].jitterSeed = ancestorIndex(0)

*.ue[*].numApps = 1
*.ue[*].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[*].app[0].localPort = 3000
*.ue[*].app[0].deadlineMs = 2.5ms
*.ue[*].app[0].expectedFrames = 1074

#------------------------------------#
# Config XR-DL-Dataset
#
# Multi-user XR downlink for ML dataset generation
# Features:
# - Large deployment area (500m x 500m) for CQI diversity
# - Aggressive UE mobility (5-20 m/s)
# - Mix of near/far initial positions
# - PF scheduler with 5ms deadline
#------------------------------------#
[Config XR-DL-Dataset]
extends = NR-XR-Base

############### Larger Deployment Area ##################
# Override to 800m x 800m for greater distance variation and lower CQI
**.mobility.constraintAreaMaxX = 800m
**.mobility.constraintAreaMaxY = 800m

############### gNB at center of larger area ##################
*.gnb.mobility.initialX = 400m
*.gnb.mobility.initialY = 400m

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"

############## UE configuration ##################
*.numUe = ${numUsers=2,3,4,5,6,7,8,9,10}

# Very aggressive Random Waypoint Mobility for CQI variation
*.ue[*].mobility.typename = "RandomWaypointMobility"
*.ue[*].mobility.speed = uniform(10mps, 30mps)  # Fast movement (cycling to driving)
*.ue[*].mobility.waitTime = 0s  # No waiting, continuous movement

# Mix of NEAR, MID, and FAR users for diverse CQI values
# NEAR users: ~50-100m from gNB center (CQI ~13-15)
*.ue[0].mobility.initialX = uniform(350m, 450m)
*.ue[0].mobility.initialY = uniform(350m, 450m)

# FAR users at CORNERS: ~400-500m from center (CQI ~5-8)
*.ue[1].mobility.initialX = uniform(50m, 150m)
*.ue[1].mobility.initialY = uniform(50m, 150m)
*.ue[2].mobility.initialX = uniform(650m, 750m)
*.ue[2].mobility.initialY = uniform(650m, 750m)
*.ue[4].mobility.initialX = uniform(50m, 150m)
*.ue[4].mobility.initialY = uniform(650m, 750m)
*.ue[5].mobility.initialX = uniform(650m, 750m)
*.ue[5].mobility.initialY = uniform(50m, 150m)

# MID-RANGE users: ~150-250m from center (CQI ~9-12)
*.ue[3].mobility.initialX = uniform(200m, 300m)
*.ue[3].mobility.initialY = uniform(400m, 500m)
*.ue[6].mobility.initialX = uniform(500m, 600m)
*.ue[6].mobility.initialY = uniform(300m, 400m)
*.ue[7].mobility.initialX = uniform(300m, 400m)
*.ue[7].mobility.initialY = uniform(150m, 250m)
*.ue[8].mobility.initialX = uniform(450m, 550m)
*.ue[8].mobility.initialY = uniform(550m, 650m)
*.ue[9].mobility.initialX = uniform(200m, 300m)
*.ue[9].mobility.initialY = uniform(200m, 300m)

#============= Application Setup =============
# Server sends XR traffic to all UEs (downlink)
*.server.numApps = ${numUsers}

*.server.app[*].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[*].destAddress = "ue[" + string(ancestorIndex(0)) + "]"
*.server.app[*].destPort = 3000
*.server.app[*].localPort = 3088 + ancestorIndex(0)
*.server.app[*].startTime = uniform(0s, 0.02s)
*.server.app[*].fps = 60
*.server.app[*].pcaFile = "pca_sweep_summary_scaled.csv"
*.server.app[*].compressionLevel = 0  # Will be set dynamically by script

# Jitter parameters
*.server.app[*].jitterMean = -4ms
*.server.app[*].jitterStd = 2ms
*.server.app[*].jitterMin = -4ms
*.server.app[*].jitterMax = 4ms
*.server.app[*].jitterSeed = ancestorIndex(0)

# UE receivers
*.ue[*].numApps = 1
*.ue[*].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[*].app[0].localPort = 3000
*.ue[*].app[0].deadlineMs = 5ms  # 5ms delay bound for dataset
*.ue[*].app[0].expectedFrames = 1074

