[General]
sim-time-limit = 20s
**.routingRecorder.enabled = false

# Configure enough RNGs for all jitter sources
num-rngs = 20

############### Statistics ##################
output-scalar-file = ${resultdir}/${configname}/${repetition}.sca
output-vector-file = ${resultdir}/${configname}/${repetition}.vec
seed-set = ${repetition}
**.vector-recording = true

############### Mobility parameters #####################
# 250m x 250m deployment area as per specification
**.mobility.constraintAreaMaxX = 250m
**.mobility.constraintAreaMaxY = 250m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.initFromDisplayString = false

############### IPv4 configurator config #################
*.configurator.config = xmldoc("./demo.xml")


#------------------------------------#
# Config NR-XR-Base
#
# Base configuration for NR Standalone with XR traffic parameters
# Uses 100 MHz bandwidth, μ=1 numerology (30 kHz SCS), ~273 RBs
#------------------------------------#
[Config NR-XR-Base]
network = simu5g.simulations.NR.networks.SingleCell_Standalone

############### Carrier Configuration ################
*.carrierAggregation.numComponentCarriers = 1
*.carrierAggregation.componentCarrier[0].carrierFrequency = 2.4GHz
*.carrierAggregation.componentCarrier[0].numBands = 273
*.carrierAggregation.componentCarrier[0].numerologyIndex = 1  # μ=1, 30 kHz SCS

############### Number of Resource Blocks ################
**.numBands = 273  # 100 MHz with 30 kHz SCS

############### gNodeB configuration #################
# gNB positioned at center of 250m x 250m area (BS antenna height: 25m)
*.gnb.mobility.initialX = 125m
*.gnb.mobility.initialY = 125m

############### Transmission Power ##################
# From specification: BS max power = 44 dBm, UE tx power = 23 dBm
**.ueTxPower = 23dBm
**.eNodeBTxPower = 44dBm
**.targetBler = 0.01  # Target BLER = 1%
**.blerShift = 5

############### Channel Model ##################
# Flat Rayleigh fading as per specification
**.channelModel.fading = true
**.channelModel.fading_type = "RAYLEIGH"
**.channelModel.shadowing = false  # Flat channel (no shadowing)

############## UE configuration ##################
*.numUe = 1  # Default: single user (will be overridden in specific configs)

# Connect UEs to gNB (NR Standalone mode)
*.ue[*].macCellId = 0
*.ue[*].masterId = 0
*.ue[*].nrMacCellId = 1
*.ue[*].nrMasterId = 1


#------------------------------------#
# Config XR-DL-SingleUser
#
# Single user XR downlink scenario
# Used to verify baseline operation and that 1 user can be supported
#------------------------------------#
[Config XR-DL-SingleUser]
extends = NR-XR-Base

############### Scheduler ##################
**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"

############## UE configuration ##################
*.numUe = 1

# UE positioned within the 250m x 250m area
*.ue[0].mobility.initialX = 175m
*.ue[0].mobility.initialY = 175m

#============= Application Setup =============
# Server sends XR traffic to UE (downlink)
*.server.numApps = 1

*.server.app[0].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[0].destAddress = "ue[0]"
*.server.app[0].destPort = 3000
*.server.app[0].localPort = 3088
*.server.app[0].startTime = 0.1s
*.server.app[0].fps = 60
*.server.app[0].pcaFile = "pca_selected.csv"

# Jitter parameters (truncated Gaussian: mean -4ms, std 2ms, min -4ms, max +4ms)
*.server.app[0].jitterMean = -4ms
*.server.app[0].jitterStd = 2ms
*.server.app[0].jitterMin = -4ms
*.server.app[0].jitterMax = 4ms
*.server.app[0].jitterSeed = 0

# UE receives XR traffic
*.ue[0].numApps = 1
*.ue[0].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[0].app[0].localPort = 3000
*.ue[0].app[0].deadlineMs = 2.5ms   # 2.5 ms delay bound
*.ue[0].app[0].expectedFrames = 390  # Matches frame count in csv data
*.ue[0].app[0].resultFile = "results/user_0_stats.csv"


#------------------------------------#
# Config XR-MultiUser-Base
#
# Common base for multi-user configurations
# Contains shared UE positions, app config, and jitter parameters
#------------------------------------#
[Config XR-MultiUser-Base]
extends = NR-XR-Base

############## Common UE positions in 250m x 250m area ##################
*.ue[0].mobility.initialX = 125m
*.ue[0].mobility.initialY = 175m
*.ue[1].mobility.initialX = 100m
*.ue[1].mobility.initialY = 100m
*.ue[2].mobility.initialX = 150m
*.ue[2].mobility.initialY = 100m
*.ue[3].mobility.initialX = 100m
*.ue[3].mobility.initialY = 150m
*.ue[4].mobility.initialX = 150m
*.ue[4].mobility.initialY = 150m
*.ue[5].mobility.initialX = 75m
*.ue[5].mobility.initialY = 125m
*.ue[6].mobility.initialX = 175m
*.ue[6].mobility.initialY = 125m
*.ue[7].mobility.initialX = 125m
*.ue[7].mobility.initialY = 75m
*.ue[8].mobility.initialX = 80m
*.ue[8].mobility.initialY = 80m
*.ue[9].mobility.initialX = 170m
*.ue[9].mobility.initialY = 170m

#============= Application Setup =============
# Server sends XR traffic to all UEs (downlink)
*.server.app[*].typename = "simu5g.apps.xr.XRTrafficSource"
*.server.app[*].destAddress = "ue[" + string(ancestorIndex(0)) + "]"
*.server.app[*].destPort = 3000
*.server.app[*].localPort = 3088 + ancestorIndex(0)
*.server.app[*].startTime = uniform(0s, 0.02s)
*.server.app[*].fps = 60
*.server.app[*].pcaFile = "pca_selected.csv"

# Jitter parameters (truncated Gaussian: mean -4ms, std 2ms, min -4ms, max +4ms)
*.server.app[*].jitterMean = -4ms
*.server.app[*].jitterStd = 2ms
*.server.app[*].jitterMin = -4ms
*.server.app[*].jitterMax = 4ms
*.server.app[*].jitterSeed = ancestorIndex(0)

# All UEs receive XR traffic
*.ue[*].numApps = 1
*.ue[*].app[0].typename = "simu5g.apps.xr.XRTrafficReceiver"
*.ue[*].app[0].localPort = 3000
*.ue[*].app[0].deadlineMs = 2.5ms   # 2.5 ms delay bound
*.ue[*].app[0].expectedFrames = 390  # Matches frame count in csv data


#------------------------------------#
# Config XR-DL-MultiUser-PF
#
# Multi-user XR downlink with Proportional Fair scheduler
# Variable number of users (2-10) to study capacity limits
#------------------------------------#
[Config XR-DL-MultiUser-PF]
extends = XR-MultiUser-Base

**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"
*.numUe = ${numUsers=2,3,4,5,6,7,8,9,10}
*.server.numApps = ${numUsers}


#------------------------------------#
# Config XR-DL-MultiUser-MaxCQI
#
# Multi-user XR downlink with MAX-CQI scheduler
# Variable number of users (2-10) to study capacity limits
#------------------------------------#
[Config XR-DL-MultiUser-MaxCQI]
extends = XR-MultiUser-Base

**.gnb.cellularNic.mac.schedulingDisciplineDl = "MAXCI"
*.numUe = ${numUsers=2,3,4,5,6,7,8,9,10}
*.server.numApps = ${numUsers}


#------------------------------------#
# Config XR-DL-UserSweep
#
# Sweep number of users from 1 to 10 with PF scheduler
# Used to generate results showing capacity limits
#------------------------------------#
[Config XR-DL-UserSweep]
extends = XR-MultiUser-Base

**.gnb.cellularNic.mac.schedulingDisciplineDl = "PF"
*.numUe = ${numUsers=1,2,3,4,5,6,7,8,9,10}
*.server.numApps = ${numUsers}

# akfghkaehfkqalij